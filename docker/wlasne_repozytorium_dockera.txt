Jak skonfigurowaÄ‡ Dockera do pobierania obrazÃ³w z wÅ‚asnego (prywatnego) repozytorium

PoniÅ¼ej znajdziesz kompletnÄ… instrukcjÄ™ krok po kroku.
âœ… 1. Rodzaje wÅ‚asnych repozytoriÃ³w
ğŸ”¹ A. Lokalny registry (np. na Twoim serwerze)

PrzykÅ‚ad: registry.mycompany.local:5000
ğŸ”¹ B. Prywatny repozytorium w chmurze

Np.:

    Docker Hub (private repository)

    GitHub Container Registry

    GitLab Container Registry

    AWS ECR, GCP Artifact Registry, Azure ACR

ğŸ”§ 2. Konfiguracja dla prywatnego registry z samopodpisanym certyfikatem

JeÅ›li Twoje repozytorium ma self-signed cert, musisz dodaÄ‡ wyjÄ…tek w konfiguracji Dockera.
ğŸ“ Na kliencie Docker:

    UtwÃ³rz katalog konfiguracyjny:

sudo mkdir -p /etc/docker/certs.d/registry.mycompany.local:5000

    Skopiuj tam swÃ³j certyfikat CA:

sudo cp myregistry.crt /etc/docker/certs.d/registry.mycompany.local:5000/ca.crt

âš ï¸ 3. JeÅ›li korzystasz z rejestru bez HTTPS (testowo)

Dla niezabezpieczonego (insecure) registry, edytuj plik:

    /etc/docker/daemon.json

Dodaj lub zmodyfikuj:

{
  "insecure-registries": ["registry.mycompany.local:5000"]
}

NastÄ™pnie przeÅ‚aduj Dockera:

sudo systemctl restart docker

ğŸ”‘ 4. Logowanie do repozytorium z autoryzacjÄ…

JeÅ›li Twoje repo wymaga logowania (np. prywatne Docker Hub lub GitHub CR):

docker login registry.mycompany.local:5000

WprowadÅº login i hasÅ‚o (lub token dostÄ™pu, jeÅ›li konfigurujesz CI/CD).
ğŸ“¦ 5. Pobieranie obrazÃ³w

Po konfiguracji:

docker pull registry.mycompany.local:5000/nazwa_obrazu:tag

PrzykÅ‚ad:

docker pull registry.mycompany.local:5000/myapp:latest

ğŸ”„ 6. Push do wÅ‚asnego registry

JeÅ›li budujesz wÅ‚asny obraz i chcesz wysÅ‚aÄ‡ go do swojego repo:

docker tag myapp:latest registry.mycompany.local:5000/myapp:latest
docker push registry.mycompany.local:5000/myapp:latest

ğŸ“ 7. Podsumowanie

âœ… Skonfiguruj certyfikat CA lub insecure-registries
âœ… Zaloguj siÄ™ przez docker login, jeÅ›li wymagana jest autoryzacja
âœ… UÅ¼ywaj peÅ‚nej nazwy rejestru w pull i push
ğŸ’¡ Dodatkowe: uruchomienie wÅ‚asnego lokalnego registry (na testy)

docker run -d -p 5000:5000 --restart=always --name registry registry:2

PÃ³Åºniej moÅ¼esz push/pull na adres localhost:5000.
